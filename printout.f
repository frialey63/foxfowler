      PROGRAM PRINTOUT

C      ASHMOLE SCHOOL PROJECT P.PARLETT 18 FEB
C      PROGRAM 08
C      FILE STATUS TEST

C     "INITIALISE ARRAYS AND SPECIAL VARIABLES"
      DIMENSION BANKYR(2), BRNAME (3), NAME(7),
     &BALMTH(3), TRANMH(3), TRANDE(7), EOF(2)
      DATA EOF(1), EOF(2)/ 4HZZZZ, 4HZZZZ/
      INTEGER CODENO, SHEETN, BALDT, TRANDT

C     "CHECK USER"
      CALL USERCHECK

C     "VALID USER"
      WRITE(6,1)

C     "READ IN A RECORD"
   21 READ(4,2) BANKYR
      DO 80 N=1,2
          I = 4
          CALL COMP(I,BANKYR(N), 1, EOF (N), 1)
          IF (I.NE.4) GO TO 81
   80 CONTINUE
      GO TO 22

C     "PRINT OUT HEADER FIELDS"
   81 READ(4,3) BRNAME, NAME, CODENO,SHEETN, BALFWD, BALDT, BALMTH
      WRITE(6,4) BANKYR
      WRITE(6,5) BRNAME
      WRITE(6,6) NAME
      WRITE(6,7) CODENO
      WRITE(6,8) SHEETN
      WRITE(6,9) BALFWD
      WRITE(6,10) BALDT
      WRITE(6,11) BALMTH

C     "READ IN TRANSACTION"
      READ(4,12) TRANDT
      IF (TRANDT.EQ.99) GO TO 20
      WRITE(6,13)
   19 WRITE(6,10) TRANDT
C     "PRINT OUT TRANSACTION"
      READ(4,15) TRANMH, TRANDE, DEBS, CREDS
      WRITE(6,16) TRANMH
      WRITE(6,17) TRANDE
      WRITE(6,18) DEBS
      WRITE(4,18) CREDS
      READ(4,12) TRANDT
      IF (TRANDT.EQ.99) GO TO 20
      GO TO 19
   20 WRITE(6,10) TRANDT
      WRITE(6,23)
      GO TO 21

C     "FILE PRINT OUT COMPLETED"
   22 WRITE(6,4) BANKYR
      WRITE(6,23)

      STOP

    1 FORMAT(1H /1H /1H , 26HPRINT OUT MASTER FILE MODE/1H /1H )
    2 FORMAT(2A4)
    3 FORMAT(3A4,7A4, I10, I4, F11.0, I2, 3A1)
    4 FORMAT(1H ,2A4)
    5 FORMAT(1H ,3A4)
    6 FORMAT(1H ,7A4)
    7 FORMAT(1H ,I10)
    8 FORMAT(1H ,I4)
    9 FORMAT(1H ,F11.2)
   10 FORMAT(1H ,I2)
   11 FORMAT(1H ,3A1)
   12 FORMAT(I2)
   13 FORMAT(1H /1H ,10X, 12HTRANSACTIONS)
   15 FORMAT(3A1, 7A4, 2F10.0)
   16 FORMAT(1H , 3A1)
   17 FORMAT(1H , 7A4)
   18 FORMAT(1H , F10.2)
   23 FORMAT(1H /1H /1H /1H )

      END
